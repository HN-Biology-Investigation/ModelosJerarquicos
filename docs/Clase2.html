<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="David Murillo">

<title>Clase 1: Modelos N-Mixture para estimar abundancia</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Clase2_files/libs/clipboard/clipboard.min.js"></script>
<script src="Clase2_files/libs/quarto-html/quarto.js"></script>
<script src="Clase2_files/libs/quarto-html/popper.min.js"></script>
<script src="Clase2_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Clase2_files/libs/quarto-html/anchor.min.js"></script>
<link href="Clase2_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Clase2_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Clase2_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Clase2_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Clase2_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Clase 1: Modelos N-Mixture para estimar abundancia</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>David Murillo </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="introducci√≥n-a-los-modelos-de-abundancia" class="level2">
<h2 class="anchored" data-anchor-id="introducci√≥n-a-los-modelos-de-abundancia">Introducci√≥n a los modelos de abundancia</h2>
<p>La abundancia, o el tama√±o poblacional, se refiere al n√∫mero de individuos en un lugar y tiempo determinados. Normalmente, denotamos la abundancia como <em>Nùëñùë°</em> , dondo <em>i</em> representa el lugar (espacio) y <em>t</em> es un √≠ndice para el tiempo. Sin duda, la abundancia debe ser la variable de estado m√°s importante en toda la ecolog√≠a. Esto se ilustra claramente por el hecho de que varios libros influyentes de ecolog√≠a tienen la palabra ‚Äúabundancia‚Äù en su t√≠tulo (por ejemplo, Andrewartha y Birch, 1954; Krebs, 2009).</p>
<p>Cuando contamos animales o plantas, estamos midiendo abundancia: un conteo <em>C</em> es una medida de la abundancia. Al medir la abundancia, existen exactamente dos tipos posibles de errores de medici√≥n: (1) podemos pasar por alto o no detectar a un individuo, o (2) podemos contar a un individuo varias veces o incluir otra especie en el conteo (identificaci√≥n err√≥nea de la especie). El primero representa un error de falso negativo (o de detecci√≥n) y conduce a un sesgo negativo en el conteo en relaci√≥n con la abundancia, mientras que los dos √∫ltimos representan errores de falso positivo y conducen a un sesgo positivo en el conteo en relaci√≥n con la abundancia. Estos son los tipos de errores m√°s fundamentales en cualquier medici√≥n de abundancia. Hay otras fuentes de errores; por ejemplo, para estudiar el tama√±o de una poblaci√≥n de adultos territoriales de alguna especie, pero no ser capaz de distinguir juveniles de adultos o individuos territoriales de individuos transitorios. Sin embargo, si realmente no puedes distinguirlos, en cierto sentido esto no es un error, sino simplemente que se est√° pidiendo demasiado. Necesitamos redefinir nuestro <em>N</em> para abarcar juveniles, adultos, locales y transitorios por igual. Por lo tanto, esto es un problema de c√≥mo defines <em>N</em>.</p>
</section>
<section id="modelo-n-mixture-para-abundancia" class="level2">
<h2 class="anchored" data-anchor-id="modelo-n-mixture-para-abundancia">Modelo <em>N-mixture</em> para abundancia</h2>
<p>El modelo N-mixture <a href="https://doi.org/10.1111/j.0006-341X.2004.00142.x">(Royle, 2004b)</a> es posiblemente el modelo jer√°rquico (HM) m√°s representativo para estimar la abundancia animal. Similar al modelo de ocupaci√≥n, el dise√±o de muestreo tiene una estructura de medidas repetidas, donde se muestrean <em>M</em> sitios en <em>I</em> ocasiones (por ejemplo, conteos puntuales de aves en <em>I</em> ma√±anas dentro de la misma temporada), y se registran los individuos de una especie. Las observaciones son los conteos <em>y</em>, y el modelo de observaci√≥n se asume que sigue una distribuci√≥n binomial, condicionada al tama√±o real de la poblaci√≥n en el sitio <em>i</em>:</p>
<p><span class="math display">\[y_{ij}| \sim Binomial(N_i,p)\]</span></p>
<p>Aqu√≠, <em>p</em> representa la probabilidad de detecci√≥n a nivel individual (en contraste con la probabilidad de detecci√≥n a nivel de sitio en el modelo de ocupaci√≥n). Generalmente, se pueden modelar factores que influyen en la detecci√≥n utilizando modelos lineales generalizados (GLMs) con la funci√≥n de enlace logit, pero por ahora se omite esta generalidad. Al igual que en el modelo de ocupaci√≥n, es necesario contar con conteos repetidos (es decir, ‚Äúmediciones de abundancia‚Äù) en al menos algunos sitios para garantizar la identificabilidad de los par√°metros del modelo. La variable de estado en este caso es el ‚Äútama√±o local de la poblaci√≥n‚Äù, <em>N</em>, y el GLM de Poisson es el marco natural para modelar la variaci√≥n en esta variable de estado:</p>
<p><span class="math display">\[N_i \sim Poisson(\lambda_i)\]</span></p>
<p>En casi todos los estudios, existe inter√©s en modelar el efecto de covariables medibles, por lo que se consideran modelos para el logaritmo de <em>Œª</em> (es decir, el enlace can√≥nico para GLMs de Poisson):</p>
<p><span class="math display">\[log(\lambda) = \beta_0 + \beta_1x_i\]</span></p>
<p>donde <em>x</em> es alguna covariable a nivel de sitio. Por supuesto, tambi√©n se pueden considerar modelos alternativos para la abundancia local, como el Poisson inflado con ceros, el Poisson lognormal o el binomial negativo, que consideran la variaci√≥n excesiva (o sobredispersi√≥n) en la abundancia local en comparaci√≥n con el modelo de Poisson.</p>
<p>Al igual que el modelo de ocupaci√≥n, el modelo N-mixture es un tipo de GLM compuesto: tanto el modelo de observaci√≥n como el de proceso son GLMs est√°ndar, pero est√°n vinculados mediante la estructura de dependencia condicional del modelo jer√°rquico. Los modelos N-mixture se implementan en el programa PRESENCE (Hines, 2006), en el programa MARK (White y Burnham, 1999), y en el paquete unmarked de R mediante la funci√≥n pcount.</p>
</section>
<section id="el-paquete-de-r-unmarked" class="level2">
<h2 class="anchored" data-anchor-id="el-paquete-de-r-unmarked"><strong>EL Paquete de R <code>unmarked</code></strong></h2>
<p>El paquete de R unmarked (<a href="https://doi.org/10.18637/jss.v043.i10">Fiske y Chandler, 2011</a>) proporciona una plataforma integral para el an√°lisis de muchos de los modelos jer√°rquicos (HMs) que cubrimos en este curso. Implementa estimaciones basadas en verosimilitud marginal y ofrece funciones de soporte para la organizaci√≥n de datos, res√∫menes y an√°lisis gr√°ficos. El paquete fue desarrollado originalmente por Ian Fiske como estudiante de posgrado en la Universidad Estatal de Carolina del Norte, y fue asumido en gran medida por Richard Chandler alrededor del a√±o 2011.</p>
<p>El paquete unmarked ofrece un marco unificado para la manipulaci√≥n de datos, exploraci√≥n de datos, ajuste de modelos (mediante m√°xima verosimilitud), selecci√≥n de modelos, promediado de modelos, evaluaci√≥n del ajuste del modelo (Gof, por sus siglas en ingl√©s), predicci√≥n, e implementa ideas como bootstrapping, predicci√≥n, estimaci√≥n emp√≠rica Bayesiana y otros procedimientos de inferencia y an√°lisis. Los modelos jer√°rquicos principales disponibles en unmarked son los siguientes:</p>
<ul>
<li><p>Modelo de ocupaci√≥n por sitios de una sola temporada (‚Äúest√°tico‚Äù) (MacKenzie et al., 2002; Tyre et al., 2003)</p></li>
<li><p>Modelo est√°tico de Royle-Nichols (Royle y Nichols, 2003)</p></li>
<li><p>Modelo est√°tico de ocupaci√≥n con falsos positivos (Royle y Link, 2006; Miller et al., 2011)</p></li>
<li><p>Modelos est√°ticos de ocupaci√≥n penalizada (Hutchinson et al., 2015)</p></li>
<li><p>Modelo est√°tico binomial de mezcla N (Royle, 2004b)</p></li>
<li><p>Modelo est√°tico multinomial de mezcla N (Royle, 2004a; Dorazio et al., 2005; Langtimm et al., 2011)</p></li>
<li><p>Modelo jer√°rquico est√°tico de muestreo por distancias (Royle et al., 2004)</p></li>
<li><p>Versiones de ‚Äúpoblaci√≥n abierta‚Äù para muchos de los anteriores: 1) Modelo din√°mico de ocupaci√≥n (MacKenzie et al., 2003), 2) Modelo de mezcla multinomial con emigraci√≥n temporal (Chandler et al., 2011), 3) Muestreo por distancias con emigraci√≥n temporal, modelo din√°mico de <em>N</em>-Mixture (Dail y Madsen, 2011), muestreo por distancias din√°mico (Sollmann et al., 2015).</p></li>
</ul>
<p>Con frecuencia, los modeladores jer√°rquicos en formaci√≥n tienen dificultades para determinar qu√© tipo de modelo deber√≠an utilizar para abordar un problema espec√≠fico. Una clave dicot√≥mica simple puede ayudar a guiar al usuario hacia la funcionalidad adecuada de unmarked (Figura 2.1).</p>
<p><img src="booksPictures/Screenshot%202024-11-19%20071853.png" class="img-fluid"> Figura 2.1 √Årbol de decisi√≥n para los modelos disponibles en el paquete de R unmarked. Una pregunta cient√≠fica o de manejo (el signo de interrogaci√≥n en el cuadro superior) sugiere primero un enfoque en abundancia u ocurrencia; en segundo lugar, si el sistema es est√°tico o din√°mico; y en tercer lugar, el m√©todo de muestreo utilizado. Todos estos factores determinan el modelo apropiado para su estudio.</p>
</section>
<section id="ejercicio" class="level2">
<h2 class="anchored" data-anchor-id="ejercicio">Ejercicio</h2>
<p>Voluntarios experimentados realizan un recorrido transecto irregular, espec√≠fico para cada cuadrante, cuya longitud var√≠a entre 1 y 9 km. Cada transecto se recorre tres veces durante la temporada de cr√≠a (de mediados de abril a principios de julio) utilizando el m√©todo de mapeo de territorios (Bibby et al., 2000). Los cuadrantes situados en √°reas altas (por encima de la l√≠nea de √°rboles) se inspeccionan solo dos veces. Los recorridos comienzan al amanecer y duran en promedio cuatro horas (SD = 1 h). Los observadores registran en un mapa la ubicaci√≥n de cada individuo de cada especie identificada. Posteriormente, los territorios provisionales se determinan en funci√≥n de la agrupaci√≥n de observaciones y, para los registros aislados, en funci√≥n del conocimiento de los tama√±os t√≠picos de los territorios de cada especie.</p>
<p>Aqu√≠ analizaremos los conteos por cuadrante del n√∫mero de territorios de carbonero com√∫n (<em>Parus major</em>) (<em>y</em>) en el cuadrante <em>i</em> durante el recorrido <em>j</em> en 2013. El conjunto de datos incluye coordenadas del sitio y covariables como elevaci√≥n (m), cobertura forestal (%), y longitud de la ruta (km), as√≠ como covariables observacionales como la fecha (d√≠a 1 = 1 de abril) y la duraci√≥n (min) de cada recorrido.</p>
<p>Los objetivos de nuestro an√°lisis son dos:</p>
<ul>
<li><p>Identificar los factores ambientales que afectan la abundancia de carboneros comunes en Suiza.</p></li>
<li><p>Estimar el tama√±o de la poblaci√≥n de carboneros comunes en Suiza en 2013.</p></li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">Cargar base de datos</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">Formatear base de datos a formato unmarked</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false" href="">Ajustar modelo de deteccion</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false" href="">Ajustar modelo de Abundancia</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-5" role="tab" aria-controls="tabset-1-5" aria-selected="false" href="">Seleccion de modelo de abundancia</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-6" role="tab" aria-controls="tabset-1-6" aria-selected="false" href="">Resumen de los resultados</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-7" role="tab" aria-controls="tabset-1-7" aria-selected="false" href="">Bondad de ajuste</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-8" role="tab" aria-controls="tabset-1-8" aria-selected="false" href="">Prepar data para graficar</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-9-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-9" role="tab" aria-controls="tabset-1-9" aria-selected="false" href="">Graficar modelo</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(unmarked)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AICcmodavg)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MuMIn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>Tits <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/Tits.csv"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(Tits)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   263 obs. of  21 variables:
 $ X1       : int  25 20 4 12 0 4 12 7 10 5 ...
 $ X2       : int  16 10 4 11 1 1 11 10 14 6 ...
 $ X3       : int  16 12 1 6 0 4 4 5 4 6 ...
 $ siteID   : chr  "Q001" "Q002" "Q003" "Q004" ...
 $ coordx   : int  922942 928942 928942 934942 934942 946942 946942 952942 958942 958942 ...
 $ coordy   : int  63276 79276 103276 95276 111276 95276 111276 119276 111276 127276 ...
 $ AQ       : int  1 2 3 3 4 5 6 7 9 10 ...
 $ AQ.coordx: int  920442 930942 930942 930942 930942 950942 950942 950942 960942 960942 ...
 $ AQ.coordy: int  170224 190724 210724 210724 220724 210724 220724 230724 220724 240724 ...
 $ elev     : int  450 450 1050 950 1150 550 750 650 550 550 ...
 $ rlength  : num  6.4 5.5 4.3 4.5 5.4 3.6 3.9 6.1 5.8 4.5 ...
 $ forest   : int  3 21 32 9 35 2 6 60 5 13 ...
 $ time.1   : int  1 1 1 1 1 1 1 1 1 1 ...
 $ time.2   : int  2 2 2 2 2 2 2 2 2 2 ...
 $ time.3   : int  3 3 3 3 3 3 3 3 3 3 ...
 $ date.1   : int  18 13 26 13 24 31 14 37 18 29 ...
 $ date.2   : int  41 49 58 35 45 44 45 57 41 58 ...
 $ date.3   : int  63 62 75 63 66 68 66 73 56 68 ...
 $ dur.1    : int  195 201 210 175 235 120 195 210 185 220 ...
 $ dur.2    : int  220 215 210 175 170 135 255 210 205 215 ...
 $ dur.3    : int  230 190 210 165 220 120 165 180 170 225 ...</code></pre>
</div>
</div>
<p>Seleccionar variables necesarias</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>Tits <span class="ot">&lt;-</span> Tits <span class="sc">%&gt;%</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(X1, X2, X3,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>         elev, forest,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>         time<span class="fl">.1</span>, time<span class="fl">.2</span>, time<span class="fl">.3</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>         date<span class="fl">.1</span>, date<span class="fl">.2</span>, date<span class="fl">.3</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>         dur<span class="fl">.1</span>, dur<span class="fl">.2</span>, dur<span class="fl">.3</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Tits)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  X1 X2 X3 elev forest time.1 time.2 time.3 date.1 date.2 date.3 dur.1 dur.2
1 25 16 16  450      3      1      2      3     18     41     63   195   220
2 20 10 12  450     21      1      2      3     13     49     62   201   215
3  4  4  1 1050     32      1      2      3     26     58     75   210   210
4 12 11  6  950      9      1      2      3     13     35     63   175   175
5  0  1  0 1150     35      1      2      3     24     45     66   235   170
6  4  1  4  550      2      1      2      3     31     44     68   120   135
  dur.3
1   230
2   190
3   210
4   165
5   220
6   120</code></pre>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> Tits[,<span class="fu">c</span>(<span class="st">"X1"</span>, <span class="st">"X2"</span>, <span class="st">"X3"</span>)]</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>SiteVar <span class="ot">&lt;-</span> Tits[,<span class="fu">c</span>(<span class="st">"elev"</span>, <span class="st">"forest"</span>)]</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>ObsVar <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">Time =</span> Tits[,<span class="fu">c</span>(<span class="st">"time.1"</span>, <span class="st">"time.2"</span>, <span class="st">"time.3"</span>)],</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">Date =</span> Tits[,<span class="fu">c</span>(<span class="st">"date.1"</span>, <span class="st">"date.2"</span>, <span class="st">"date.3"</span>)],</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">Dur =</span> Tits[,<span class="fu">c</span>(<span class="st">"dur.1"</span>, <span class="st">"dur.2"</span>, <span class="st">"dur.3"</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>Tits_umf <span class="ot">&lt;-</span> <span class="fu">unmarkedFramePCount</span>(<span class="at">y =</span> y, <span class="at">siteCovs =</span> SiteVar, </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">obsCovs=</span> ObsVar )</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Tits_umf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>unmarkedFrame Object

263 sites
Maximum number of observations per site: 3 
Mean number of observations per site: 2.83 
Sites with at least one detection: 191 

Tabulation of y observations:
   0    1    2    3    4    5    6    7    8    9   10   11   12   13   14   15 
 215   45   32   33   42   34   37   34   26   24   24   20   24   23   19   18 
  16   17   18   19   20   21   22   23   24   25   26   27   28   29   30   31 
  16    8   12    8    4    6    3    5    7    5    2    2    1    1    2    2 
  32   33   34   35   38   41 &lt;NA&gt; 
   1    2    1    3    1    1   46 

Site-level covariates:
      elev          forest     
 Min.   : 250   Min.   : 0.00  
 1st Qu.: 550   1st Qu.: 8.50  
 Median :1150   Median :33.00  
 Mean   :1190   Mean   :34.88  
 3rd Qu.:1850   3rd Qu.:56.50  
 Max.   :2750   Max.   :99.00  

Observation-level covariates:
      Time        Date             Dur       
 Min.   :1   Min.   : 13.00   Min.   : 85.0  
 1st Qu.:1   1st Qu.: 35.00   1st Qu.:195.0  
 Median :2   Median : 56.00   Median :231.0  
 Mean   :2   Mean   : 54.59   Mean   :232.3  
 3rd Qu.:3   3rd Qu.: 72.50   3rd Qu.:270.0  
 Max.   :3   Max.   :118.00   Max.   :420.0  
             NA's   :46       NA's   :46     </code></pre>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>ModelDet0 <span class="ot">&lt;-</span> <span class="fu">pcount</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">~</span><span class="dv">1</span>, Tits_umf ) <span class="do">##Null model</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>ModelDet1 <span class="ot">&lt;-</span> <span class="fu">pcount</span>(<span class="sc">~</span>Date <span class="sc">~</span><span class="dv">1</span>, Tits_umf )</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>ModelDet2 <span class="ot">&lt;-</span> <span class="fu">pcount</span>(<span class="sc">~</span>Time <span class="sc">~</span><span class="dv">1</span>, Tits_umf )</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>ModelDet3 <span class="ot">&lt;-</span> <span class="fu">pcount</span>(<span class="sc">~</span>Dur <span class="sc">~</span><span class="dv">1</span>, Tits_umf )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="seleccion-de-modelo-de-deteccion" class="level2">
<h2 class="anchored" data-anchor-id="seleccion-de-modelo-de-deteccion">Seleccion de modelo de deteccion</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>DetModels <span class="ot">&lt;-</span> <span class="fu">list</span>(ModelDet0, ModelDet1, ModelDet2, ModelDet3)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>DetNames <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Nulo"</span>, <span class="st">"Fecha"</span>, <span class="st">"Hora"</span>, <span class="st">"Dur"</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">aictab</span>(DetModels, DetNames, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Model selection based on AICc:

      K    AICc Delta_AICc AICcWt Cum.Wt       LL
Fecha 3 5133.62       0.00      1      1 -2563.77
Hora  3 5722.78     589.16      0      1 -2858.34
Dur   3 5993.25     859.63      0      1 -2993.58
Nulo  2 6012.56     878.93      0      1 -3004.25</code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>ModelAbun0 <span class="ot">&lt;-</span> <span class="fu">pcount</span>(<span class="sc">~</span>Date <span class="sc">~</span> <span class="dv">1</span>, Tits_umf) </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>ModelAbun1 <span class="ot">&lt;-</span> <span class="fu">pcount</span>(<span class="sc">~</span>Date <span class="sc">~</span> elev, Tits_umf)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>ModelAbun2 <span class="ot">&lt;-</span> <span class="fu">pcount</span>(<span class="sc">~</span>Date <span class="sc">~</span> forest, Tits_umf)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>ModelAbun3 <span class="ot">&lt;-</span> <span class="fu">pcount</span>(<span class="sc">~</span>Date <span class="sc">~</span> elev <span class="sc">+</span> forest, Tits_umf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>AbunModels <span class="ot">&lt;-</span> <span class="fu">list</span>(ModelAbun0, ModelAbun1, ModelAbun2, ModelAbun3)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>AbunNames <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Nulo"</span>, <span class="st">"elev"</span>, <span class="st">"forest"</span>, <span class="st">"elev + forest"</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">aictab</span>(AbunModels, AbunNames, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Model selection based on AICc:

              K    AICc Delta_AICc AICcWt Cum.Wt       LL
elev + forest 5 4012.77       0.00      1      1 -2001.27
elev          4 4972.13     959.36      0      1 -2481.99
Nulo          3 5133.62    1120.86      0      1 -2563.77
forest        4 5135.26    1122.49      0      1 -2563.55</code></pre>
</div>
</div>
</div>
<div id="tabset-1-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-6-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ModelAbun3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
pcount(formula = ~Date ~ elev + forest, data = Tits_umf)

Abundance (log-scale):
            Estimate       SE      z  P(&gt;|z|)
(Intercept)  4.05815 5.52e-02  73.46 0.00e+00
elev        -0.00186 3.19e-05 -58.34 0.00e+00
forest       0.00540 7.22e-04   7.48 7.72e-14

Detection (logit-scale):
            Estimate      SE      z  P(&gt;|z|)
(Intercept)   0.8186 0.12576   6.51 7.54e-11
Date         -0.0183 0.00133 -13.73 6.97e-43

AIC: 4012.535 
Number of sites: 263
optim convergence code: 0
optim iterations: 164 
Bootstrap iterations: 0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(ModelAbun3, <span class="at">type =</span> <span class="st">"state"</span>, <span class="at">level =</span> <span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   0.025        0.975
lam(Int)     3.949865692  4.166426167
lam(elev)   -0.001921411 -0.001796500
lam(forest)  0.003981345  0.006811154</code></pre>
</div>
</div>
</div>
<div id="tabset-1-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-7-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>fitstats <span class="ot">&lt;-</span> <span class="cf">function</span>(Mod_global2) {</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  observed <span class="ot">&lt;-</span> <span class="fu">getY</span>(Mod_global2<span class="sc">@</span>data)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  expected <span class="ot">&lt;-</span> <span class="fu">fitted</span>(Mod_global2)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  resids <span class="ot">&lt;-</span> <span class="fu">residuals</span>(Mod_global2)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  sse <span class="ot">&lt;-</span> <span class="fu">sum</span>(resids<span class="sc">^</span><span class="dv">2</span>,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  chisq <span class="ot">&lt;-</span> <span class="fu">sum</span>((observed <span class="sc">-</span> expected)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> expected,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  freeTuke <span class="ot">&lt;-</span> <span class="fu">sum</span>((<span class="fu">sqrt</span>(observed) <span class="sc">-</span> <span class="fu">sqrt</span>(expected))<span class="sc">^</span><span class="dv">2</span>,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">SSE=</span>sse, <span class="at">Chisq=</span>chisq, <span class="at">freemanTukey=</span>freeTuke)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>(pb <span class="ot">&lt;-</span> <span class="fu">parboot</span>(ModelAbun3, fitstats, <span class="at">nsim=</span><span class="dv">100</span>, <span class="at">report=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call: 
parboot(object = ModelAbun3, statistic = fitstats, nsim = 100, report = 1)

Parametric Bootstrap Statistics:
                t0 mean(t0 - t_B) StdDev(t0 - t_B) Pr(t_B &gt; t0)
SSE          26345          21146            421.0            0
Chisq         3515           2767             44.8            0
freemanTukey   910            680             13.0            0

t_B quantiles:
               0% 2.5%  25%  50%  75% 97.5% 100%
SSE          3956 4408 4974 5240 5482  5975 6115
Chisq         626  666  717  750  774   833  859
freemanTukey  193  208  219  231  239   253  269

t0 = Original statistic computed from data
t_B = Vector of bootstrap samples</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>cHat_pb <span class="ot">&lt;-</span> pb<span class="sc">@</span>t0[<span class="dv">2</span>] <span class="sc">/</span> <span class="fu">mean</span>(pb<span class="sc">@</span>t.star[,<span class="dv">2</span>])</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>MigGOF <span class="ot">&lt;-</span> <span class="fu">Nmix.gof.test</span>(ModelAbun3, <span class="at">nsim =</span> <span class="dv">100</span>, <span class="at">report =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Clase2_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-8-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>Elev <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">elev =</span> <span class="fu">seq</span>(<span class="fu">min</span>(Tits<span class="sc">$</span>elev, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="fu">max</span>(Tits<span class="sc">$</span>elev, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">length.out =</span> <span class="dv">100</span>),</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">forest =</span> <span class="fu">mean</span>(Tits<span class="sc">$</span>forest, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>Forest <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">forest =</span> <span class="fu">seq</span>(<span class="fu">min</span>(Tits<span class="sc">$</span>forest, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="fu">max</span>(Tits<span class="sc">$</span>forest, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">length.out =</span> <span class="dv">100</span>),</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">elev =</span> <span class="fu">mean</span>(Tits<span class="sc">$</span>elev, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>Elev_pre <span class="ot">&lt;-</span> <span class="fu">predict</span>(ModelAbun3, <span class="at">newdata=</span> Elev, <span class="at">appendData =</span> <span class="cn">TRUE</span>, <span class="at">type =</span> <span class="st">"state"</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>Forest_pre <span class="ot">&lt;-</span> <span class="fu">predict</span>(ModelAbun3, <span class="at">newdata=</span> Forest, <span class="at">appendData =</span> <span class="cn">TRUE</span>, <span class="at">type =</span> <span class="st">"state"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-9" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-9-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span> Elev_pre, <span class="fu">aes</span>(<span class="at">x=</span> elev, <span class="at">y=</span> Predicted))<span class="sc">+</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span> lower,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymax=</span> upper), <span class="at">fill =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color=</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Elevacion"</span>, </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Abundancia"</span>)<span class="sc">+</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Abundancia explicada por la elevacion"</span>) <span class="sc">+</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Clase2_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span> Forest_pre, <span class="fu">aes</span>(<span class="at">x=</span> forest, <span class="at">y=</span> Predicted))<span class="sc">+</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span> lower,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymax=</span> upper), <span class="at">fill =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color=</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"% Bosque"</span>, </span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Abundancia"</span>)<span class="sc">+</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Abundancia explicada por el % bosque"</span>) <span class="sc">+</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Clase2_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="HN%20Cursos%20publicidad/HN%20Biology%20Inv%20large.jpg" class="img-fluid figure-img"></p>
<figcaption>HN Biology Investigation Academy</figcaption>
</figure>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>