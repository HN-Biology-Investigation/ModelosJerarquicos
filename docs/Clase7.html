<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="David Murillo">

<title>Clase 7: Modelado de interacciones entre especies (ocupación)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Clase7_files/libs/clipboard/clipboard.min.js"></script>
<script src="Clase7_files/libs/quarto-html/quarto.js"></script>
<script src="Clase7_files/libs/quarto-html/popper.min.js"></script>
<script src="Clase7_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Clase7_files/libs/quarto-html/anchor.min.js"></script>
<link href="Clase7_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Clase7_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Clase7_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Clase7_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Clase7_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


<link rel="stylesheet" href="styles.css">
</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Clase 7: Modelado de interacciones entre especies (ocupación)</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>David Murillo </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<p>Este capítulo trata sobre el modelado de interacciones entre dos o más especies en términos de patrones observados en la ocurrencia. Las interacciones entre especies son fundamentales para la ecología, ya que pueden ser resultado de mecanismos ecológicos tan importantes como la competencia, la depredación y el mutualismo, denominados colectivamente interacciones bióticas. En sentido estricto, solo los experimentos manipulativos o las observaciones conductuales directas de individuos permiten decidir si una asociación estadística observada puede atribuirse a interacciones bióticas reales, efectos ambientales o ambos mecanismos juntos. Por ejemplo, una correlación espacial negativa en la ocurrencia o abundancia de dos especies puede deberse a una interacción antagónica, como la competencia, el parasitismo o la depredación. Alternativamente, puede ser simplemente el resultado de diferentes preferencias de hábitat de las dos especies, es decir, filtrado de hábitat. O puede ser el resultado de una combinación de ambos mecanismos. Esta es quizás la advertencia principal para la mayoría de las aplicaciones de los modelos de este capítulo: que una correlación no implica necesariamente causalidad.</p>
<p>Cuando decimos “interacciones entre especies” en esta clase, nos referimos a una asociación o no independencia en los parámetros de múltiples especies en un modelo de ocurrencia. Es decir, utilizamos el término “interacción” en un sentido puramente descriptivo, estadístico o correlativo. Cubriremos modelos multiespecie para ocurrencia, que tienen parámetros específicos para dar cuenta de la posible no independencia entre pares de especies. Además, estos modelos nos permitirán, en diferentes grados, probar hipótesis sobre posibles mecanismos biológicos subyacentes a dicha no independencia entre múltiples especies. Algunos de estos modelos tienen un toque claramente mecanicista, pero ni siquiera ellos nos permitirán hacer inferencias sólidas sobre interacciones reales entre individuos de múltiples especies, a menos que tengamos el tipo correcto de datos (observaciones experimentales o de comportamiento). Sin embargo, los modelos de esta clase pueden ser herramientas poderosas para descubrir patrones: pueden señalar algunos pares de especies como candidatos para interacciones bióticas directas. El descubrimiento de fuertes asociaciones positivas o negativas en la abundancia o la ocurrencia (o posiblemente en otro parámetro) puede ser seguido por investigaciones más enfocadas en los posibles fundamentos mecanicistas de tales patrones. Además, si ajustamos estos modelos a los datos recopilados en el contexto de un experimento manipulativo diseñado para aislar algún mecanismo biológico, entonces nos permitirán hacer inferencias sólidas sobre los efectos de estos mecanismos. Y como siempre, si nuestros modelos muestran una asociación positiva o negativa que fue predicha en base a un conocimiento a priori sobre posibles interacciones bióticas entre estas especies, entonces esto proporciona una inferencia más sólida sobre la existencia de estas interacciones.</p>
<p>Referencia: <a href="https://www.sciencedirect.com/book/9780128237687/applied-hierarchical-modeling-in-ecology-analysis-of-distribution-abundance-and-species-richness-in-r-and-bugs">Aplied Hierarchical Modeling in Ecology, Volumen 2</a></p>
<p>Leer <a href="https://doi.org/10.1111/2041-210X.12587">Rota et al.&nbsp;2016</a> para mayor detalles de modelos de ocupación con multiples especies.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">Cargar paquetes</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">Cargar base de datos</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false" href="">Modelo Nulo</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false" href="">Modelo Dist</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-5" role="tab" aria-controls="tabset-1-5" aria-selected="false" href="">Modelo Dist-HDens</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-6" role="tab" aria-controls="tabset-1-6" aria-selected="false" href="">Seleccion de modelo</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-7" role="tab" aria-controls="tabset-1-7" aria-selected="false" href="">Predicciones</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-8" role="tab" aria-controls="tabset-1-8" aria-selected="false" href="">Prediccion Marginal</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-9-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-9" role="tab" aria-controls="tabset-1-9" aria-selected="false" href="">Grafico ocupación marginal</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-10-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-10" role="tab" aria-controls="tabset-1-10" aria-selected="false" href="">Prediccion condicional</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-11-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-11" role="tab" aria-controls="tabset-1-11" aria-selected="false" href="">Grafico condicional</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(unmarked)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AICcmodavg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>Leer <a href="https://link.springer.com/article/10.1007/s10980-015-0262-9">McShea et al.&nbsp;2015</a> para mayor detalles de la base de datos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>Carnivores <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"data/CarnivoreData.rds"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(Carnivores)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   1437 obs. of  15 variables:
 $ Dist_5km   : num  0.04 0.03 0.03 0.03 0.03 0.03 0.03 0.03 0.04 0.04 ...
 $ HDens_5km  : num  9.35 9.5 9.65 9.6 9.61 ...
 $ Latitude   : num  0.39 0.39 0.39 0.39 0.39 ...
 $ Longitude  : num  -0.772 -0.772 -0.772 -0.772 -0.772 ...
 $ People_site: num  0.857 0.002 0.387 0.003 0 0.443 0 0 0.002 0 ...
 $ Trail      : int  1 0 1 0 0 1 0 0 0 0 ...
 $ bobcat1    : int  0 0 0 0 0 0 0 0 0 0 ...
 $ bobcat2    : int  0 0 0 0 0 0 0 0 0 0 ...
 $ bobcat3    : int  0 0 0 0 0 0 0 0 0 0 ...
 $ coyote1    : int  0 0 0 0 0 0 0 0 0 0 ...
 $ coyote2    : int  0 0 0 0 0 0 0 0 0 0 ...
 $ coyote3    : int  0 0 0 0 0 0 0 0 0 0 ...
 $ redfox1    : int  0 0 0 0 0 1 0 0 0 0 ...
 $ redfox2    : int  0 0 0 0 0 1 0 0 0 0 ...
 $ redfox3    : int  0 0 1 0 0 1 0 0 0 0 ...</code></pre>
</div>
</div>
<section id="preparar-formato-unmarked" class="level1">
<h1>Preparar formato unmarked</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>ylist <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">bobcat =</span> <span class="fu">as.matrix</span>(Carnivores[,<span class="fu">c</span>(<span class="st">"bobcat1"</span>, <span class="st">"bobcat2"</span>, <span class="st">"bobcat3"</span> )]), </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">coyote =</span> <span class="fu">as.matrix</span>(Carnivores[,<span class="fu">c</span>(<span class="st">"coyote1"</span>, <span class="st">"coyote2"</span>, <span class="st">"coyote3"</span> )]),</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">redfox =</span> <span class="fu">as.matrix</span>(Carnivores[,<span class="fu">c</span>(<span class="st">"redfox1"</span>, <span class="st">"redfox2"</span>, <span class="st">"redfox3"</span> )]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>Dist <span class="ot">&lt;-</span> <span class="fu">scale</span>(Carnivores[,<span class="st">'Dist_5km'</span>])</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>HDens <span class="ot">&lt;-</span> <span class="fu">scale</span>(Carnivores[,<span class="st">'HDens_5km'</span>])</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>Trail <span class="ot">&lt;-</span> Carnivores[,<span class="st">'Trail'</span>]</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sitecovs <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Dist =</span> Dist, <span class="at">HDens =</span> HDens, <span class="at">Trail =</span> Trail))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Dist      HDens Trail
1 1.2017760 0.03128299     1
2 0.7361647 0.03668136     0
3 0.7361647 0.04187064     1
4 0.7361647 0.04014855     0
5 0.7361647 0.04049080     0
6 0.7361647 0.04543423     1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>umf <span class="ot">&lt;-</span> <span class="fu">unmarkedFrameOccuMulti</span>(<span class="at">y =</span> ylist, <span class="at">siteCovs =</span> sitecovs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(umf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>unmarkedFrame Object

1437 sites
3 species: bobcat coyote redfox 
Maximum number of observations per site: 3 
Mean number of observations per site:
bobcat: 3  coyote: 3  redfox: 3  
Sites with at least one detection:
bobcat: 196  coyote: 401  redfox: 161  
Tabulation of y observations:
bobcat:
   0    1 
4057  254 
coyote:
   0    1 
3685  626 
redfox:
   0    1 
4054  257 

Site-level covariates:
      Dist             HDens             Trail       
 Min.   :-0.6607   Min.   :-0.2964   Min.   :0.0000  
 1st Qu.:-0.6607   1st Qu.:-0.2892   1st Qu.:0.0000  
 Median :-0.6607   Median :-0.2708   Median :0.0000  
 Mean   : 0.0000   Mean   : 0.0000   Mean   :0.3229  
 3rd Qu.: 0.2706   3rd Qu.:-0.1905   3rd Qu.:1.0000  
 Max.   : 5.3923   Max.   : 6.2498   Max.   :1.0000  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(umf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Clase7_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>occ_formulae1 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">' ~ 1'</span>,<span class="st">' ~ 1'</span>,<span class="st">' ~ 1'</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">3</span>),</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Constant detection by species</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>det_formulae1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">' ~ 1'</span>, <span class="dv">3</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model 1</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>(fm1 <span class="ot">&lt;-</span> <span class="fu">occuMulti</span>(det_formulae1, occ_formulae1, umf))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
occuMulti(detformulas = det_formulae1, stateformulas = occ_formulae1, 
    data = umf, maxOrder = 3L)

Occupancy:
                     Estimate     SE      z  P(&gt;|z|)
[bobcat] (Intercept)   -1.171 0.1328  -8.82 1.13e-18
[coyote] (Intercept)   -0.629 0.0744  -8.46 2.79e-17
[redfox] (Intercept)   -1.846 0.0944 -19.56 3.58e-85

Detection:
                     Estimate     SE     z  P(&gt;|z|)
[bobcat] (Intercept)   -1.104 0.1396 -7.91 2.59e-15
[coyote] (Intercept)   -0.333 0.0764 -4.36 1.30e-05
[redfox] (Intercept)   -0.252 0.1182 -2.13 3.29e-02

AIC: 6710.658 </code></pre>
</div>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>occ_formulae2 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="st">' ~ Dist'</span>, <span class="dv">3</span>),</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">3</span>),</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>det_formulae2 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">'~as.factor(Trail)'</span>, <span class="dv">3</span>)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>(fm2 <span class="ot">&lt;-</span> <span class="fu">occuMulti</span>(det_formulae2, occ_formulae2, umf,</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">maxit =</span> <span class="dv">500</span>, <span class="at">trace =</span> <span class="cn">TRUE</span>, <span class="at">REPORT =</span> <span class="dv">1</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>initial  value 4145.891058 
iter   2 value 3564.392891
iter   3 value 3491.336999
iter   4 value 3345.562989
iter   5 value 3260.856435
iter   6 value 3238.918538
iter   7 value 3214.517112
iter   8 value 3205.172680
iter   9 value 3200.938826
iter  10 value 3189.861878
iter  11 value 3173.669093
iter  12 value 3164.402609
iter  13 value 3141.827898
iter  14 value 3140.705930
iter  15 value 3134.410022
iter  16 value 3128.848007
iter  17 value 3124.524109
iter  18 value 3124.432997
iter  19 value 3118.885342
iter  20 value 3117.268394
iter  21 value 3116.815868
iter  22 value 3116.769367
iter  23 value 3116.762841
iter  24 value 3116.762460
iter  24 value 3116.762441
iter  24 value 3116.762441
final  value 3116.762441 
converged</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
occuMulti(detformulas = det_formulae2, stateformulas = occ_formulae2, 
    data = umf, control = list(maxit = 500, trace = TRUE, REPORT = 1), 
    maxOrder = 3L)

Occupancy:
                     Estimate     SE        z  P(&gt;|z|)
[bobcat] (Intercept)  -0.5542 0.1587  -3.4930 4.78e-04
[bobcat] Dist         -0.5224 0.1293  -4.0413 5.32e-05
[coyote] (Intercept)   0.1917 0.1058   1.8116 7.01e-02
[coyote] Dist         -0.0069 0.0845  -0.0817 9.35e-01
[redfox] (Intercept)  -1.5358 0.1195 -12.8554 8.02e-38
[redfox] Dist         -0.2912 0.1123  -2.5926 9.53e-03

Detection:
                           Estimate     SE      z  P(&gt;|z|)
[bobcat] (Intercept)          -2.58 0.1619 -15.91 5.54e-57
[bobcat] as.factor(Trail)1     1.89 0.1714  11.02 3.01e-28
[coyote] (Intercept)          -1.96 0.0998 -19.65 5.63e-86
[coyote] as.factor(Trail)1     2.17 0.1227  17.68 5.52e-70
[redfox] (Intercept)          -1.40 0.1836  -7.61 2.80e-14
[redfox] as.factor(Trail)1     1.63 0.2186   7.44 1.00e-13

AIC: 6257.525 </code></pre>
</div>
</div>
</div>
<div id="tabset-1-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>occ_formulae3 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="st">' ~ Dist'</span>, <span class="dv">3</span>),</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="st">'~HDens'</span>, <span class="dv">3</span>),</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>det_formulae3 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">'~as.factor(Trail)'</span>, <span class="dv">3</span>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>(fm3 <span class="ot">&lt;-</span> <span class="fu">occuMulti</span>(det_formulae3, occ_formulae3, umf,</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">maxit =</span> <span class="dv">500</span>, <span class="at">trace =</span> <span class="cn">TRUE</span>, <span class="at">REPORT =</span> <span class="dv">1</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>initial  value 4145.891058 
iter   2 value 3488.834951
iter   3 value 3338.430208
iter   4 value 3161.635338
iter   5 value 3118.737722
iter   6 value 3101.048975
iter   7 value 3089.656797
iter   8 value 3082.679421
iter   9 value 3079.863756
iter  10 value 3077.335138
iter  11 value 3074.954984
iter  12 value 3073.229248
iter  13 value 3071.823713
iter  14 value 3070.168308
iter  15 value 3068.423840
iter  16 value 3067.564127
iter  17 value 3065.635251
iter  18 value 3062.916359
iter  19 value 3062.672676
iter  20 value 3060.991809
iter  21 value 3059.642503
iter  22 value 3056.550603
iter  23 value 3054.543308
iter  24 value 3051.032301
iter  25 value 3048.256038
iter  26 value 3047.596978
iter  27 value 3045.787366
iter  28 value 3044.912736
iter  29 value 3044.430405
iter  30 value 3044.063737
iter  31 value 3043.982199
iter  32 value 3043.940331
iter  33 value 3043.931549
iter  34 value 3043.928428
iter  35 value 3043.927714
iter  36 value 3043.927173
iter  37 value 3043.926743
iter  38 value 3043.926315
iter  39 value 3043.926250
iter  39 value 3043.926230
iter  39 value 3043.926214
final  value 3043.926214 
converged</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
occuMulti(detformulas = det_formulae3, stateformulas = occ_formulae3, 
    data = umf, control = list(maxit = 500, trace = TRUE, REPORT = 1), 
    maxOrder = 3L)

Occupancy:
                            Estimate    SE     z  P(&gt;|z|)
[bobcat] (Intercept)          -1.154 0.261 -4.42 9.81e-06
[bobcat] Dist                 -0.648 0.146 -4.43 9.28e-06
[coyote] (Intercept)          -0.569 0.207 -2.75 5.94e-03
[coyote] Dist                  0.203 0.106  1.91 5.64e-02
[redfox] (Intercept)          -1.844 0.246 -7.50 6.57e-14
[redfox] Dist                 -0.335 0.128 -2.62 8.91e-03
[bobcat:coyote] (Intercept)    1.046 0.374  2.80 5.17e-03
[bobcat:coyote] HDens         -2.239 0.654 -3.43 6.14e-04
[bobcat:redfox] (Intercept)   -1.545 0.427 -3.62 2.95e-04
[bobcat:redfox] HDens          1.284 0.432  2.98 2.93e-03
[coyote:redfox] (Intercept)    1.421 0.366  3.89 1.01e-04
[coyote:redfox] HDens          1.277 0.386  3.31 9.42e-04

Detection:
                           Estimate     SE      z  P(&gt;|z|)
[bobcat] (Intercept)          -2.54 0.1632 -15.57 1.22e-54
[bobcat] as.factor(Trail)1     1.83 0.1707  10.72 7.99e-27
[coyote] (Intercept)          -2.00 0.0993 -20.13 4.41e-90
[coyote] as.factor(Trail)1     2.16 0.1211  17.86 2.47e-71
[redfox] (Intercept)          -1.56 0.1621  -9.64 5.51e-22
[redfox] as.factor(Trail)1     1.82 0.2044   8.92 4.63e-19

AIC: 6123.852 </code></pre>
</div>
</div>
</div>
<div id="tabset-1-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-6-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AICcmodavg)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">aictab</span>(<span class="at">cand.set =</span>  <span class="fu">list</span>(fm1, fm2, fm3),</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">modnames =</span> <span class="fu">c</span>(<span class="st">"fm1"</span>, <span class="st">"fm2"</span>, <span class="st">"fm3"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Model selection based on AICc:

     K    AICc Delta_AICc AICcWt Cum.Wt       LL
fm3 18 6124.33       0.00      1      1 -3043.93
fm2 12 6257.74     133.41      0      1 -3116.76
fm1  6 6710.72     586.38      0      1 -3349.33</code></pre>
</div>
</div>
</div>
<div id="tabset-1-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-7-tab">
<p>Predict conditional occupancy and present in a table</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>nd <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Dist =</span> <span class="dv">0</span>, <span class="at">HDens =</span> <span class="dv">0</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>bob_none <span class="ot">&lt;-</span> <span class="fu">predict</span>(fm3, <span class="at">type =</span> <span class="st">'state'</span>, <span class="at">species =</span> <span class="st">'bobcat'</span>,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">cond =</span> <span class="fu">c</span>(<span class="st">'-coyote'</span>,<span class="st">'-redfox'</span>), <span class="at">newdata =</span> nd, <span class="at">nsims =</span> <span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Bootstrapping confidence intervals with 1000 samples</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>bob_coyote <span class="ot">&lt;-</span> <span class="fu">predict</span>(fm3,<span class="at">type =</span> <span class="st">'state'</span>,<span class="at">species =</span> <span class="st">'bobcat'</span>,</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">cond =</span> <span class="fu">c</span>(<span class="st">'coyote'</span>,<span class="st">'-redfox'</span>), <span class="at">newdata =</span> nd, <span class="at">nsims =</span> <span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Bootstrapping confidence intervals with 1000 samples</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>bob_redfox <span class="ot">&lt;-</span> <span class="fu">predict</span>(fm3,<span class="at">type =</span> <span class="st">'state'</span>,<span class="at">species =</span> <span class="st">'bobcat'</span>,</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">cond =</span> <span class="fu">c</span>(<span class="st">'-coyote'</span>,<span class="st">'redfox'</span>), <span class="at">newdata =</span> nd, <span class="at">nsims =</span> <span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Bootstrapping confidence intervals with 1000 samples</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>bob_both <span class="ot">&lt;-</span> <span class="fu">predict</span>(fm3,<span class="at">type =</span> <span class="st">'state'</span>,<span class="at">species =</span> <span class="st">'bobcat'</span>,</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">cond =</span> <span class="fu">c</span>(<span class="st">'coyote'</span>,<span class="st">'redfox'</span>), <span class="at">newdata =</span> nd, <span class="at">nsims =</span> <span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Bootstrapping confidence intervals with 1000 samples</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(occtab <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="st">'Neither'</span> <span class="ot">=</span> bob_none, <span class="st">'Coyote'</span> <span class="ot">=</span> bob_coyote,</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Red fox'</span> <span class="ot">=</span> bob_redfox, <span class="st">'Both'</span> <span class="ot">=</span> bob_both), <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Predicted    SE lower upper
Neither     0.240 0.045 0.168 0.336
Coyote      0.473 0.076 0.325 0.616
Red fox     0.063 0.032 0.028 0.152
Both        0.161 0.053 0.083 0.293</code></pre>
</div>
</div>
</div>
<div id="tabset-1-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-8-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>Dist_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Dist =</span> <span class="fu">seq</span>(<span class="fu">min</span>(sitecovs<span class="sc">$</span>Dist), <span class="fu">max</span>(sitecovs<span class="sc">$</span>Dist), <span class="at">length =</span> <span class="dv">100</span>) , </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">HDens =</span> <span class="fu">mean</span>(sitecovs<span class="sc">$</span>HDens), <span class="at">length =</span> <span class="dv">100</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>HDens_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Dist =</span> <span class="fu">mean</span>(sitecovs<span class="sc">$</span>Dist) , </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">HDens =</span> <span class="fu">seq</span>(<span class="fu">min</span>(sitecovs<span class="sc">$</span>HDens), <span class="fu">max</span>(sitecovs<span class="sc">$</span>HDens), <span class="at">length =</span> <span class="dv">100</span>))</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>coyote <span class="ot">&lt;-</span> <span class="fu">predict</span>(fm3,<span class="at">type =</span> <span class="st">'state'</span>,<span class="at">species =</span> <span class="st">'coyote'</span>,</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">newdata =</span> Dist_df, <span class="at">nsims =</span> <span class="dv">1000</span> )</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>redfox <span class="ot">&lt;-</span> <span class="fu">predict</span>(fm3,<span class="at">type =</span> <span class="st">'state'</span>,<span class="at">species =</span> <span class="st">'redfox'</span>,</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">newdata =</span> Dist_df, <span class="at">nsims =</span> <span class="dv">1000</span>)</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>bobcat <span class="ot">&lt;-</span> <span class="fu">predict</span>(fm3,<span class="at">type =</span> <span class="st">'state'</span>,<span class="at">species =</span> <span class="st">'bobcat'</span>,</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>   <span class="at">newdata =</span> Dist_df, <span class="at">nsims =</span> <span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>coyote<span class="sc">$</span>Especie <span class="ot">&lt;-</span> <span class="st">"coyote"</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>redfox<span class="sc">$</span>Especie <span class="ot">&lt;-</span> <span class="st">"redfox"</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>bobcat<span class="sc">$</span>Especie <span class="ot">&lt;-</span> <span class="st">"bobcat"</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>coyote<span class="sc">$</span>Dist <span class="ot">&lt;-</span> Dist_df<span class="sc">$</span>Dist</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>redfox<span class="sc">$</span>Dist <span class="ot">&lt;-</span> Dist_df<span class="sc">$</span>Dist</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>bobcat<span class="sc">$</span>Dist <span class="ot">&lt;-</span> Dist_df<span class="sc">$</span>Dist</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>Carnivores_plot <span class="ot">&lt;-</span> <span class="fu">rbind</span>(coyote, redfox, bobcat)</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Carnivores_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Predicted         SE     lower     upper Especie       Dist
1 0.4998692 0.03494104 0.4350980 0.5749048  coyote -0.6606690
2 0.5003237 0.03426260 0.4367531 0.5729654  coyote -0.5995281
3 0.5007859 0.03362600 0.4380192 0.5708826  coyote -0.5383872
4 0.5012569 0.03303355 0.4383048 0.5693133  coyote -0.4772464
5 0.5017378 0.03248758 0.4395733 0.5681637  coyote -0.4161055
6 0.5022295 0.03199033 0.4419435 0.5668635  coyote -0.3549646</code></pre>
</div>
</div>
</div>
<div id="tabset-1-9" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-9-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> Carnivores_plot, <span class="fu">aes</span>(<span class="at">x=</span> Dist, <span class="at">y=</span> Predicted, <span class="at">color=</span> Especie, <span class="at">fill =</span> Especie))<span class="sc">+</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span>  lower, <span class="at">ymax=</span> upper),</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha=</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span><span class="st">"ocupación Marginal"</span>,</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span> <span class="st">"Distancia en radio de 5km"</span>)<span class="sc">+</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Clase7_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-10" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-10-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>bob_redfox <span class="ot">&lt;-</span> <span class="fu">predict</span>(fm3,<span class="at">type =</span> <span class="st">'state'</span>,<span class="at">species =</span> <span class="st">'bobcat'</span>,</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">cond =</span> <span class="fu">c</span>(<span class="st">'redfox'</span>), <span class="at">newdata =</span> Dist_df, <span class="at">nsims =</span> <span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Bootstrapping confidence intervals with 1000 samples</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>bob_coyote <span class="ot">&lt;-</span> <span class="fu">predict</span>(fm3,<span class="at">type =</span> <span class="st">'state'</span>,<span class="at">species =</span> <span class="st">'bobcat'</span>,</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">cond =</span> <span class="fu">c</span>(<span class="st">'coyote'</span>), <span class="at">newdata =</span> Dist_df, <span class="at">nsims =</span> <span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Bootstrapping confidence intervals with 1000 samples</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>bob_coyote<span class="sc">$</span>Especie <span class="ot">&lt;-</span> <span class="st">"coyote"</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>bob_redfox<span class="sc">$</span>Especie <span class="ot">&lt;-</span> <span class="st">"redfox"</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>bob_coyote<span class="sc">$</span>Dist <span class="ot">&lt;-</span> Dist_df<span class="sc">$</span>Dist</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>bob_redfox<span class="sc">$</span>Dist <span class="ot">&lt;-</span> Dist_df<span class="sc">$</span>Dist</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>Bob_Condicional <span class="ot">&lt;-</span> <span class="fu">rbind</span>(bob_coyote, bob_redfox)</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Bob_Condicional )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Predicted         SE     lower     upper Especie       Dist
1 0.4709423 0.07076386 0.3367122 0.6101995  coyote -0.6606690
2 0.4626109 0.06993737 0.3305979 0.6020998  coyote -0.5995281
3 0.4542876 0.06912656 0.3225870 0.5939441  coyote -0.5383872
4 0.4459770 0.06833350 0.3154690 0.5847168  coyote -0.4772464
5 0.4376837 0.06756014 0.3105387 0.5772070  coyote -0.4161055
6 0.4294122 0.06680825 0.3031057 0.5681849  coyote -0.3549646</code></pre>
</div>
</div>
</div>
<div id="tabset-1-11" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-11-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> Bob_Condicional, <span class="fu">aes</span>(<span class="at">x=</span> Dist, <span class="at">y=</span> Predicted, <span class="at">color=</span> Especie, <span class="at">fill =</span> Especie))<span class="sc">+</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span>  lower, <span class="at">ymax=</span> upper),</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha=</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span><span class="st">"ocupación de Bobcat"</span>,</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span> <span class="st">"Distancia en radio de 5km"</span>) <span class="sc">+</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Clase7_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="HN%20Cursos%20publicidad/HN%20Biology%20Inv%20large.jpg" class="img-fluid figure-img"></p>
<figcaption>HN Biology Investigation Academy</figcaption>
</figure>
</div>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>